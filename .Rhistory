labs(y = "Eigen value (% variance)", x = "PCA axis", title = "a") +
theme(
plot.title = element_text(hjust = -0.12, vjust = -2)
)
p1
p2 = ggplot(Nf.pca_scores.metadata,
aes(MDS1, MDS2,
color = state,
shape = factor(collection_period,
levels = c("early", "modern"),
labels = c("1960s", "contemporary")
)
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
scale_color_manual(values = c25) +
scale_shape_manual(values = c(17,16)) +
labs(
color = "State/region",
shape = "Collection period",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "a"
) +
guides(color=guide_legend(ncol=2)) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.19, vjust = -2) #hjust -0.2 for main, -0.17 for supp
)
p2
p3 = ggplot(Nf.pca_scores.metadata,
aes(MDS1, MDS2,
color = Tree_species,
shape = factor(collection_period,
levels = c("early", "modern"),
labels = c("1960s", "contemporary")
)
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
scale_color_brewer(palette = "Set1") +
scale_shape_manual(values = c(17,16)) +
guides(shape = "none") + #comment for supp plot
labs(
shape = "Collection period",
color = "Tree species",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b" #b for main, c for supp
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.19, vjust = -2) #hjust -0.19 for main, -0.17 for supp
)
p3
p3 = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern"),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 50) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p3
p3 = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern"),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
#scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 50) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p3
p3 = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern"),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 45) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p3
p3 = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern"),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 40) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p3
p3 = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern"),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 45) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p3
p3.mod = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern" & !state %in% c("NH.CW", "WV", "VA")),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 45) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p3.mod
p3.mod = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern" & !state %in% c("NH.CW", "WV", "VA")),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
#scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 45) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p3.mod
p3.mod = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern" & !state %in% c("NH.CW", "WV", "VA")),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 45) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p3.mod
p3.mod = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern" & !state %in% c("NH.CW", "WV", "VA")),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 50) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p3.mod
p3.mod = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern" & !state %in% c("NH.CW", "WV", "VA")),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 45) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p3.mod
p4 = ggplot(Nf.pca_scores.metadata, aes(MDS1, MDS2, color = clust)) +
geom_point() +
scale_color_manual(values = c25) +
geom_mark_ellipse(expand = 0, aes(fill=clust), show.legend = F) +
labs(
color = "Cluster",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "c" #c for main, d for supp
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.19, vjust = -2) #hjust -0.19 for main, -0.17 for supp
)
p4
pdf("figures/pop_gen/pca/Nf.durInf.pdf", width = 16, height = 4)
grid.arrange(p2,p3,p4, ncol = 3, widths = c(0.37, 0.325, 0.305))
dev.off()
pdf("figures/pop_gen/pca/Nf.durInf.pdf", width = 16, height = 6)
grid.arrange(p2,p3,p4, ncol = 3, widths = c(0.37, 0.325, 0.305))
dev.off()
pdf("figures/pop_gen/pca/Nf.durInf.pdf", width = 18, height = 5)
grid.arrange(p2,p3,p4, ncol = 3, widths = c(0.37, 0.325, 0.305))
dev.off()
pdf("figures/pop_gen/pca/Nf.durInf.pdf", width = 19, height = 5)
grid.arrange(p2,p3,p4, ncol = 3, widths = c(0.37, 0.325, 0.305))
dev.off()
)
)
p2.mod = ggplot(Nf.pca_scores.metadata %>% filter(!state %in% c("NH.CW", "WV", "VA")),
aes(MDS1, MDS2,
color = state,
shape = factor(collection_period,
levels = c("early", "modern"),
labels = c("1960s", "contemporary")
)
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
scale_color_manual(values = c25) +
scale_shape_manual(values = c(17,16)) +
labs(
color = "State/region",
shape = "Collection period",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "a"
) +
guides(color=guide_legend(ncol=2)) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.19, vjust = -2) #hjust -0.2 for main, -0.17 for supp
)
p2.mod
p4 = ggplot(Nf.pca_scores.metadata, aes(MDS1, MDS2, color = clust)) +
geom_point() +
scale_color_manual(values = c25) +
geom_mark_ellipse(expand = 0, aes(fill=clust), show.legend = F) +
labs(
color = "Cluster",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "c" #c for main, d for supp
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2) #hjust -0.19 for main, -0.17 for supp
)
p3 = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern"),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 45) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2)
)
p2 = ggplot(Nf.pca_scores.metadata,
aes(MDS1, MDS2,
color = state,
shape = factor(collection_period,
levels = c("early", "modern"),
labels = c("1960s", "contemporary")
)
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
scale_color_manual(values = c25) +
scale_shape_manual(values = c(17,16)) +
labs(
color = "State/region",
shape = "Collection period",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "a"
) +
guides(color=guide_legend(ncol=2)) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.17, vjust = -2) #hjust -0.2 for main, -0.17 for supp
)
pdf("figures/pop_gen/pca/Nf.durInf.pdf", width = 19, height = 5)
grid.arrange(p2,p3,p4, ncol = 3, widths = c(0.37, 0.325, 0.305))
dev.off()
p2 = ggplot(Nf.pca_scores.metadata,
aes(MDS1, MDS2,
color = state,
shape = factor(collection_period,
levels = c("early", "modern"),
labels = c("1960s", "contemporary")
)
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
scale_color_manual(values = c25) +
scale_shape_manual(values = c(17,16)) +
labs(
color = "State/region",
shape = "Collection period",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "a"
) +
guides(color=guide_legend(ncol=2)) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.16, vjust = -2) #hjust -0.2 for main, -0.17 for supp
)
p3 = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern"),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2, position = position_jitter(width = 0.015)) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 45) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.16, vjust = -2)
)
p4 = ggplot(Nf.pca_scores.metadata, aes(MDS1, MDS2, color = clust)) +
geom_point() +
scale_color_manual(values = c25) +
geom_mark_ellipse(expand = 0, aes(fill=clust), show.legend = F) +
labs(
color = "Cluster",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "c" #c for main, d for supp
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.16, vjust = -2) #hjust -0.19 for main, -0.17 for supp
)
pdf("figures/pop_gen/pca/Nf.durInf.pdf", width = 19, height = 5)
grid.arrange(p2,p3,p4, ncol = 3, widths = c(0.37, 0.325, 0.305))
dev.off()
p2 = ggplot(Nf.pca_scores.metadata,
aes(MDS1, MDS2,
color = state,
shape = factor(collection_period,
levels = c("early", "modern"),
labels = c("1960s", "contemporary")
)
)
) +
geom_point(size = 2) +
scale_color_manual(values = c25) +
scale_shape_manual(values = c(17,16)) +
labs(
color = "State/region",
shape = "Collection period",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "a"
) +
guides(color=guide_legend(ncol=2)) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.15, vjust = -2) #hjust -0.2 for main, -0.17 for supp
)
p2
p2.mod = ggplot(Nf.pca_scores.metadata %>% filter(!state %in% c("NH.CW", "WV", "VA")),
aes(MDS1, MDS2,
color = state,
shape = factor(collection_period,
levels = c("early", "modern"),
labels = c("1960s", "contemporary")
)
)
) +
geom_point(size = 2) +
scale_color_manual(values = c25) +
scale_shape_manual(values = c(17,16)) +
labs(
color = "State/region",
shape = "Collection period",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "a"
) +
guides(color=guide_legend(ncol=2)) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.15, vjust = -2) #hjust -0.2 for main, -0.17 for supp
)
p2.mod
p3 = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern"),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 45) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.15, vjust = -2)
)
p3
p3.mod = ggplot(Nf.pca_scores.metadata %>% filter(collection_period == "modern" & !state %in% c("NH.CW", "WV", "VA")),
aes(MDS1, MDS2,
color = duration_infection
)
) +
geom_point(size = 2) +
labs(
color = "Infestation\nduration (yrs)",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "b"
) +
scale_color_gradient2(high = "#2166ac", low = "#b2182b", mid = "#d1e5f0", midpoint = 45) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.15, vjust = -2)
)
p3.mod
p4 = ggplot(Nf.pca_scores.metadata, aes(MDS1, MDS2, color = clust)) +
geom_point() +
scale_color_manual(values = c25) +
geom_mark_ellipse(expand = 0, aes(fill=clust), show.legend = F) +
labs(
color = "Cluster",
x = paste0("PCA1 (", round(Nf.eig_vals[1],3)*100, "% variance)"),
y = paste0("PCA2 (", round(Nf.eig_vals[2],3)*100, "% variance)"),
title = "c" #c for main, d for supp
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.15, vjust = -2) #hjust -0.19 for main, -0.17 for supp
)
p4
pdf("figures/pop_gen/pca/Nf.durInf.pdf", width = 19, height = 5)
grid.arrange(p2,p3,p4, ncol = 3, widths = c(0.37, 0.325, 0.305))
dev.off()
ln(0.993)
log(0.993)
q(save="no")
