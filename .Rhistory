Nd.Dgeo.long = reshape2::melt(Nd.Dgeo %>% as.matrix)
#Need to set self comps to NA (zero dists, i.e., same site, have been removed already..)
Nf.Dgeo.long[Nf.Dgeo.long$Var1 == Nf.Dgeo.long$Var2, "value"] = NA
Nd.Dgeo.long[Nd.Dgeo.long$Var1 == Nd.Dgeo.long$Var2, "value"] = NA
#set gen dists to NA where geo dist == NA
Nf.Dgen.mat = Nf.Dgen %>% as.matrix
#set gen dists to NA where geo dist == NA
Nf.Dgen.mat = dist.Nf %>% as.matrix
diag(Nf.Dgen.mat) = NA
Nf.Dgen.mat[upper.tri(Nf.Dgen.mat)] = NA
Nf.Dgen.long = reshape2::melt(dist.Nf %>% as.matrix)
Nd.Dgen.mat = dist.Nd %>% as.matrix
diag(Nd.Dgen.mat) = NA
Nd.Dgen.mat[upper.tri(Nd.Dgen.mat)] = NA
Nd.Dgen.long = reshape2::melt(dist.Nd %>% as.matrix)
Nf.Dgen.long[is.na(Nf.Dgeo.long$value), "value"] = NA
Nd.Dgen.long[is.na(Nd.Dgeo.long$value), "value"] = NA
Nf.Ddur.mat = Nf.Ddur %>% as.matrix
diag(Nf.Ddur.mat) = NA
Nf.Ddur.mat[upper.tri(Nf.Ddur.mat)] = NA
Nf.Ddur.long = reshape2::melt(Nf.Ddur.mat)
Nf.Ddur.long %>% filter(Var1 == "NG121" & Var2 == "NG4")
Nf.Ddur.long %>% filter(Var1 == "NG4" & Var2 == "NG121")
Nd.Ddur.mat = Nd.Ddur %>% as.matrix
diag(Nd.Ddur.mat) = NA
Nd.Ddur.mat[upper.tri(Nd.Ddur.mat)] = NA
Nd.Ddur.long = reshape2::melt(Nd.Ddur.mat %>% as.matrix)
#Need to set self comps to NA (zero dists, i.e., same site, have been removed already..)
sum(is.na(Nf.Ddur.long$value))
Nf.Ddur.long[Nf.Ddur.long$Var1 == Nf.Ddur.long$Var2, "value"] = NA
sum(is.na(Nf.Ddur.long$value))
Nd.Ddur.long[Nd.Ddur.long$Var1 == Nd.Ddur.long$Var2, "value"] = NA
colnames(Nf.Dgeo.long)[3] = "km"
colnames(Nf.Ddur.long)[3] = "durDif"
colnames(Nf.Dgen.long)[3] = "SNPsPerKb"
colnames(Nd.Dgeo.long)[3] = "km"
colnames(Nd.Ddur.long)[3] = "durDif"
colnames(Nd.Dgen.long)[3] = "SNPsPerKb"
Nf.long = full_join(Nf.Dgeo.long, Nf.Ddur.long) %>%
full_join(., Nf.Dgen.long)
nrow(Nf.long)
nrow(Nf.Dgeo.long)
nrow(Nf.Dgen.long)
Nd.long = full_join(Nd.Dgeo.long, Nd.Ddur.long) %>%
full_join(., Nd.Dgen.long)
sum(is.na(Nf.Ddur.long$value))
sum(is.na(Nf.Dgen.long$value))
Nf.Dgeo.long
head(Nf.Ddur.long)
head(Nf.Dgen.long)
sum(is.na(Nf.Dgeo.long$durDif))
sum(is.na(Nf.Dgeo.long$km))
sum(is.na(Nf.Ddur.long$durDif))
sum(is.na(Nf.Dgen.long$SNPsPerKb))
Nf.geo.mantel = mantel(dist.Nf, Nf.Dgeo, na.rm = T)
Nd.geo.mantel = mantel(dist.Nd, Nd.Dgeo, na.rm = T)
Nf.dur.mantel = mantel(dist.Nf, Nf.Ddur, na.rm = T)
Nd.dur.mantel = mantel(dist.Nd, Nd.Ddur, na.rm = T)
cor.test(Nf.long$km, Nf.long$SNPsPerKb, na.action = na.rm)
cor.test(Nf.long$durDif, Nf.long$SNPsPerKb, na.action = na.rm)
cor.test(Nd.long$km, Nd.long$SNPsPerKb, na.action = na.rm)
cor.test(Nd.long$durDif, Nd.long$SNPsPerKb, na.action = na.rm)
Nf.geo.mantel.stat = round(Nf.geo.mantel$statistic,2)
Nf.geo.mantel.sig = round(Nf.geo.mantel$signif,3)
p1 = ggplot(Nf.long, aes(x = km, y = SNPsPerKb)) +
geom_point(alpha = 0.08, shape = 1) +
geom_smooth(method = "lm", linetype = 1, color = "white", linewidth = 2) +
geom_smooth(method = "lm", linetype = 1, color = "black") +
scale_y_continuous(breaks = c(3,4,5)) +
labs(x = "Geographic distance (km)", y = "Hamming distance (SNPs per Kb)", title = "a") +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nf.geo.mantel.stat, ", ", italic("P"), " = ", !!Nf.geo.mantel.sig)),
x = 1475,
y = 2.5
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.10)
)
p1
Nd.geo.mantel.stat = round(Nd.geo.mantel$statistic,2)
Nd.geo.mantel.sig = round(Nd.geo.mantel$signif,2)
p2 = ggplot(Nd.long, aes(x = km, y = SNPsPerKb)) +
geom_point(alpha = 0.25, shape = 1) +
geom_smooth(method = "lm", linetype = 2, color = "black") +
labs(x = "Geographic distance (km)", y = "Hamming distance (SNPs per Kb)", title = "b") +
scale_y_continuous(breaks = c(1,4,7,10)) +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nd.geo.mantel.stat, ", ", italic("P"), " = ", !!Nd.geo.mantel.sig, 1)),
x = 1600,
y = 0.75
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.06),
axis.title.y = element_blank()
)
p2
pdf("figures/pop_gen/IBD/IBD.pdf", width = 10, height = 3.5)
grid.arrange(p1,p2,ncol = 2)
dev.off()
png("figures/pop_gen/IBD/IBD.png", width = 10, height = 3.5, units = "in", res = 300)
grid.arrange(p1,p2,ncol = 2)
dev.off()
#duration
Nf.dur.mantel.stat = round(Nf.dur.mantel$statistic,2)
Nf.dur.mantel.sig = round(Nf.dur.mantel$signif,3)
p3 = ggplot(Nf.long, aes(x = durDif, y = SNPsPerKb)) +
geom_point(alpha = 0.08, shape = 1) +
geom_smooth(method = "lm", linetype = 1, color = "white", linewidth = 2) +
geom_smooth(method = "lm", linetype = 1, color = "black") +
labs(x = "Difference in infestation duration (years)", y = "Hamming distance (SNPs per Kb)", title = "a") +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nf.dur.mantel.stat, ", ", italic("P"), " = ", !!Nf.dur.mantel.sig)),
x = 61,
y = 2.5
) +
scale_y_continuous(breaks = c(2,3,4,5)) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.10)
)
p3
Nd.dur.mantel.stat = round(Nd.dur.mantel$statistic,2)
Nd.dur.mantel.sig = round(Nd.dur.mantel$signif,2)
p4 = ggplot(Nd.long, aes(x = durDif, y = SNPsPerKb)) +
geom_point(alpha = 0.25, shape = 1) +
geom_smooth(method = "lm", linetype = 2, color = "black") +
labs(x = "Difference in infestation duration (years)", y = "Hamming distance (SNPs per Kb)", title = "b") +
scale_y_continuous(breaks = c(1,4,7,10)) +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nd.dur.mantel.stat, ", ", italic("P"), " = ", !!Nd.dur.mantel.sig)),
x = 69,
y = 0.75
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.06),
axis.title.y = element_blank()
)
p4
pdf("figures/pop_gen/IBD/IB_durationInfection.pdf", width = 10, height = 3.5)
grid.arrange(p3,p4,ncol = 2)
dev.off()
png("figures/pop_gen/IBD/IB_durationInfection.png", width = 10, height = 3.5, units = "in", res = 300)
grid.arrange(p3,p4,ncol = 2)
dev.off()
p1 = ggplot(Nf.long, aes(x = km, y = SNPsPerKb)) +
geom_point(alpha = 0.08, shape = 1) +
geom_smooth(method = "lm", linetype = 1, color = "white", linewidth = 2) +
geom_smooth(method = "lm", linetype = 1, color = "black") +
scale_y_continuous(breaks = c(3,4,5)) +
labs(x = "Geographic distance (km)", y = "Hamming distance (SNPs per Kb)", title = "a") +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nf.geo.mantel.stat, ", ", italic("P"), " = ", !!Nf.geo.mantel.sig)),
x = 1475,
y = 2.5
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.10, vjust = -1),
axis.title.x = element_blank()
)
p1
p2 = ggplot(Nd.long, aes(x = km, y = SNPsPerKb)) +
geom_point(alpha = 0.25, shape = 1) +
geom_smooth(method = "lm", linetype = 2, color = "black") +
labs(x = "Geographic distance (km)", y = "Hamming distance (SNPs per Kb)", title = "c") +
scale_y_continuous(breaks = c(1,4,7,10)) +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nd.geo.mantel.stat, ", ", italic("P"), " = ", !!Nd.geo.mantel.sig,1)),
x = 1600,
y = 0.75
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.115, vjust = -1)
)
p3 = ggplot(Nf.long, aes(x = durDif, y = SNPsPerKb)) +
geom_point(alpha = 0.08, shape = 1) +
geom_smooth(method = "lm", linetype = 1, color = "white", linewidth = 2) +
geom_smooth(method = "lm", linetype = 1, color = "black") +
labs(x = "Difference in infestation duration (years)", y = "", title = "b") +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nf.dur.mantel.stat, ", ", italic("P"), " = ", !!Nf.dur.mantel.sig)),
x = 61,
y = 2.5
) +
scale_y_continuous(breaks = c(2,3,4,5)) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.04, vjust = -1),
#axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank()
)
p3
p4 = ggplot(Nd.long, aes(x = durDif, y = SNPsPerKb)) +
geom_point(alpha = 0.25, shape = 1) +
geom_smooth(method = "lm", linetype = 2, color = "black") +
labs(x = "Difference in infestation duration (years)", y = "", title = "d") +
scale_y_continuous(breaks = c(1,4,7,10)) +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nd.dur.mantel.stat, ", ", italic("P"), " = ", !!Nd.dur.mantel.sig)),
x = 69,
y = 0.75
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.04, vjust = -1),
#axis.title.y = element_blank(),
axis.text.y = element_blank()
)
p4
pdf("figures/pop_gen/IBD/IBD_durationInfection.four_panel.pdf", width = 10, height = 7)
grid.arrange(p1,p3,p2,p4,ncol = 2)
dev.off()
p4
p4 = ggplot(Nd.long, aes(x = durDif, y = SNPsPerKb)) +
geom_point(alpha = 0.25, shape = 1, position = position_jitter(w = 0.1)) +
geom_smooth(method = "lm", linetype = 2, color = "black") +
labs(x = "Difference in infestation duration (years)", y = "", title = "d") +
scale_y_continuous(breaks = c(1,4,7,10)) +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nd.dur.mantel.stat, ", ", italic("P"), " = ", !!Nd.dur.mantel.sig)),
x = 69,
y = 0.75
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.04, vjust = -1),
#axis.title.y = element_blank(),
axis.text.y = element_blank()
)
p4
p4 = ggplot(Nd.long, aes(x = durDif, y = SNPsPerKb)) +
geom_point(alpha = 0.25, shape = 1, position = position_jitter(w = 0.1)) +
geom_smooth(method = "lm", linetype = 2, color = "black") +
labs(x = "Difference in infestation duration (years)", y = "", title = "c") +
scale_y_continuous(breaks = c(1,4,7,10)) +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nd.dur.mantel.stat, ", ", italic("P"), " = ", !!Nd.dur.mantel.sig)),
x = 69,
y = 0.75
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.04, vjust = -1),
#axis.title.y = element_blank(),
axis.text.y = element_blank()
)
p4
p4 = ggplot(Nd.long, aes(x = durDif, y = SNPsPerKb)) +
geom_point(alpha = 0.25, shape = 1, position = position_jitter(w = 1)) +
geom_smooth(method = "lm", linetype = 2, color = "black") +
labs(x = "Difference in infestation duration (years)", y = "", title = "d") +
scale_y_continuous(breaks = c(1,4,7,10)) +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nd.dur.mantel.stat, ", ", italic("P"), " = ", !!Nd.dur.mantel.sig)),
x = 69,
y = 0.75
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.04, vjust = -1),
#axis.title.y = element_blank(),
axis.text.y = element_blank()
)
p4
p4 = ggplot(Nd.long, aes(x = durDif, y = SNPsPerKb)) +
geom_point(alpha = 0.25, shape = 1) +
geom_smooth(method = "lm", linetype = 2, color = "black") +
labs(x = "Difference in infestation duration (years)", y = "", title = "d") +
scale_y_continuous(breaks = c(1,4,7,10)) +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nd.dur.mantel.stat, ", ", italic("P"), " = ", !!Nd.dur.mantel.sig)),
x = 69,
y = 0.75
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.04, vjust = -1),
#axis.title.y = element_blank(),
axis.text.y = element_blank()
)
p4
p1 = ggplot(Nf.long, aes(x = km, y = SNPsPerKb)) +
geom_point(alpha = 0.16, shape = 1) +
geom_smooth(method = "lm", linetype = 1, color = "white", linewidth = 2) +
geom_smooth(method = "lm", linetype = 1, color = "black") +
scale_y_continuous(breaks = c(3,4,5)) +
labs(x = "Geographic distance (km)", y = "Hamming distance (SNPs per Kb)", title = "a") +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nf.geo.mantel.stat, ", ", italic("P"), " = ", !!Nf.geo.mantel.sig)),
x = 1475,
y = 2.5
) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.10, vjust = -1),
axis.title.x = element_blank()
)
p3 = ggplot(Nf.long, aes(x = durDif, y = SNPsPerKb)) +
geom_point(alpha = 0.16, shape = 1) +
geom_smooth(method = "lm", linetype = 1, color = "white", linewidth = 2) +
geom_smooth(method = "lm", linetype = 1, color = "black") +
labs(x = "Difference in infestation duration (years)", y = "", title = "b") +
annotate(
geom = "text",
label = expr(paste("Mantel r = ", !!Nf.dur.mantel.stat, ", ", italic("P"), " = ", !!Nf.dur.mantel.sig)),
x = 61,
y = 2.5
) +
scale_y_continuous(breaks = c(2,3,4,5)) +
my_gg_theme.def_size +
theme(
plot.title = element_text(hjust = -0.04, vjust = -1),
#axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.title.x = element_blank()
)
pdf("figures/pop_gen/IBD/IBD_durationInfection.four_panel.pdf", width = 10, height = 7)
grid.arrange(p1,p3,p2,p4,ncol = 2)
dev.off()
Nf.Dgeo.long %>% filter(Var1 == "NG121" & Var2 == "NG4")
Nf.Dgeo.long %>% filter(Var1 == "NG4" & Var2 == "NG121")
library(dplyr)
library(ggplot2)
library(gridExtra)
library(vegan)
library(geosphere)
source("library/ggplot_theme.txt")
sample_metadata.Nf = read.csv("data/sample_metadata/Nf_filtered.lat_lon_dur_inf.csv")
sample_metadata.Nd = read.csv("data/sample_metadata/Nd_filtered.lat_lon_dur_inf.csv")
sample_metadata = rbind(sample_metadata.Nf %>% filter(collection_period == "modern"),
sample_metadata.Nd %>% filter(collection_period == "modern")
) %>% select(duration_infection, lat, lon, state) %>%
distinct
Dgeo = distm(x = sample_metadata[,c("lon", "lat")], fun = distVincentyEllipsoid)
rownames(Dgeo) = sample_metadata$state
colnames(Dgeo) = sample_metadata$state
Ddur = dist(x = sample_metadata$duration_infection) %>% as.matrix
rownames(Ddur) = sample_metadata$state
colnames(Ddur) = sample_metadata$state
mantel(Ddur, Dgeo)
Dgeo.long = reshape2::melt(Dgeo)
Dgeo.long %>% filter(Var1 == "NY.N" & Var2 == "NY.S")
Ddur.long = reshape2::melt(Ddur)
Ddur.long %>% filter(Var1 == "NY.N" & Var2 == "NY.S")
colnames(Dgeo.long)[3] = "km"
Dgeo.long$km = Dgeo.long$km/1000
colnames(Ddur.long)[3] = "durDif"
full_dat = left_join(Dgeo.long, Ddur.long, by = c("Var1", "Var2"))
Dgeo.long %>% filter(Var1 == "NH.CCM" & Var2 == "QC.OUC")
Dgeo.long %>% filter(Var2 == "NH.CCM" & Var1 == "QC.OUC")
sample_metadata$state %N% nrow()
sample_metadata$state %n% length()
sample_metadata$state %>% length()
sample_metadata$state %>% unique() %>% length()
sample_metadata$state
sample_metadata.Nd
sample_metadata.Nf
sample_metadata
sample_metadata[-28,]
#We get rid of one NH.CCM row because the Nf and Nd collections have slightly different coords
sample_metadata = sample_metadata[-28,]
sample_metadata$state %>% length()
sample_metadata$state %>% unique() %>% length()
Dgeo = distm(x = sample_metadata[,c("lon", "lat")], fun = distVincentyEllipsoid)
rownames(Dgeo) = sample_metadata$state
colnames(Dgeo) = sample_metadata$state
Ddur = dist(x = sample_metadata$duration_infection) %>% as.matrix
rownames(Ddur) = sample_metadata$state
colnames(Ddur) = sample_metadata$state
mantel(Ddur, Dgeo)
Dgeo.long = reshape2::melt(Dgeo)
Dgeo.long %>% filter(Var1 == "NY.N" & Var2 == "NY.S")
Ddur.long = reshape2::melt(Ddur)
Ddur.long %>% filter(Var1 == "NY.N" & Var2 == "NY.S")
colnames(Dgeo.long)[3] = "km"
Dgeo.long$km = Dgeo.long$km/1000
colnames(Ddur.long)[3] = "durDif"
full_dat = left_join(Dgeo.long, Ddur.long, by = c("Var1", "Var2"))
library(dplyr)
library(ggplot2)
library(gridExtra)
library(vegan)
library(geosphere)
source("library/ggplot_theme.txt")
sample_metadata.Nf = read.csv("data/sample_metadata/Nf_filtered.lat_lon_dur_inf.csv")
sample_metadata.Nd = read.csv("data/sample_metadata/Nd_filtered.lat_lon_dur_inf.csv")
sample_metadata = rbind(sample_metadata.Nf %>% filter(collection_period == "modern"),
sample_metadata.Nd %>% filter(collection_period == "modern")
) %>% select(duration_infection, lat, lon, state) %>%
distinct
#We get rid of one NH.CCM row because the Nf and Nd collections have slightly different coords
sample_metadata = sample_metadata[-28,]
sample_metadata$state %>% length()
sample_metadata$state %>% unique() %>% length()
Dgeo = distm(x = sample_metadata[,c("lon", "lat")], fun = distVincentyEllipsoid)
rownames(Dgeo) = sample_metadata$state
colnames(Dgeo) = sample_metadata$state
Ddur = dist(x = sample_metadata$duration_infection) %>% as.matrix
rownames(Ddur) = sample_metadata$state
colnames(Ddur) = sample_metadata$state
mantel(Ddur, Dgeo)
Dgeo.long = reshape2::melt(Dgeo)
Dgeo.long %>% filter(Var1 == "NY.N" & Var2 == "NY.S")
Ddur.long = reshape2::melt(Ddur)
Ddur.long %>% filter(Var1 == "NY.N" & Var2 == "NY.S")
colnames(Dgeo.long)[3] = "km"
Dgeo.long$km = Dgeo.long$km/1000
colnames(Ddur.long)[3] = "durDif"
full_dat = left_join(Dgeo.long, Ddur.long, by = c("Var1", "Var2"))
Dgeo.long %>% filter(Var1 == "NH.CCM" & Var2 == "QC.OUC")
Dgeo.long %>% filter(Var2 == "NH.CCM" & Var1 == "QC.OUC")
library(dplyr)
library(ggplot2)
library(gridExtra)
library(vegan)
library(geosphere)
source("library/ggplot_theme.txt")
sample_metadata.Nf = read.csv("data/sample_metadata/Nf_filtered.lat_lon_dur_inf.csv")
sample_metadata.Nd = read.csv("data/sample_metadata/Nd_filtered.lat_lon_dur_inf.csv")
sample_metadata = rbind(sample_metadata.Nf %>% filter(collection_period == "modern"),
sample_metadata.Nd %>% filter(collection_period == "modern")
) %>% select(duration_infection, lat, lon, state) %>%
distinct
#We get rid of one NH.CCM row because the Nf and Nd collections have slightly different coords
sample_metadata = sample_metadata[-28,]
sample_metadata$state %>% length()
sample_metadata$state %>% unique() %>% length()
Dgeo = distm(x = sample_metadata[,c("lon", "lat")], fun = distVincentyEllipsoid)
rownames(Dgeo) = sample_metadata$state
colnames(Dgeo) = sample_metadata$state
Ddur = dist(x = sample_metadata$duration_infection) %>% as.matrix
rownames(Ddur) = sample_metadata$state
colnames(Ddur) = sample_metadata$state
#we are not naming by state because there are two QC.OU sites with different coords
#this is because there is one for Nf and one for Nd
mantel(Ddur, Dgeo)
#Mantel statistic r:     0.7499
#Significance: 0.001
Dgeo.mat = Dgeo %>% as.matrix
diag(Dgeo.mat) = NA
Dgeo.mat[upper.tri(Dgeo.mat)] = NA
Dgeo.long = reshape2::melt(Dgeo)
Dgeo.long %>% filter(Var1 == "NY.N" & Var2 == "NY.S")
Ddur.mat = Ddur %>% as.matrix
diag(Ddur.mat) = NA
Ddur.mat[upper.tri(Ddur.mat)] = NA
Ddur.long = reshape2::melt(Ddur)
Ddur.long %>% filter(Var1 == "NY.N" & Var2 == "NY.S")
colnames(Dgeo.long)[3] = "km"
Dgeo.long$km = Dgeo.long$km/1000
colnames(Ddur.long)[3] = "durDif"
full_dat = left_join(Dgeo.long, Ddur.long, by = c("Var1", "Var2"))
Dgeo.long %>% filter(Var1 == "NH.CCM" & Var2 == "QC.OUC")
Dgeo.long %>% filter(Var2 == "NH.CCM" & Var1 == "QC.OUC")
Dgeo.long = reshape2::melt(Dgeo.mat)
Dgeo.long %>% filter(Var1 == "NY.N" & Var2 == "NY.S")
Ddur.long = reshape2::melt(Ddur.mat)
Ddur.long %>% filter(Var1 == "NY.N" & Var2 == "NY.S")
colnames(Dgeo.long)[3] = "km"
Dgeo.long$km = Dgeo.long$km/1000
colnames(Ddur.long)[3] = "durDif"
full_dat = left_join(Dgeo.long, Ddur.long, by = c("Var1", "Var2"))
Dgeo.long %>% filter(Var1 == "NH.CCM" & Var2 == "QC.OUC")
Dgeo.long %>% filter(Var2 == "NH.CCM" & Var1 == "QC.OUC")
p1 = ggplot(full_dat, aes(x = km, y = durDif)) +
geom_point(alpha = 0.25, shape = 1) +
#geom_smooth(method = "lm", linetype = 1, color = "white", linewidth = 2) +
geom_smooth(method = "lm", linetype = 1, color = "black") +
labs(x = "Geographic distance (km)", y = "Difference in infestation duration (years)") +
annotate(
geom = "text",
label = expression(paste("Mantel r = 0.74,", italic("P"), " = 0.001")),
x = 1750,
y = 2.5
) +
my_gg_theme.def_size
p1
p1 = ggplot(full_dat, aes(x = km, y = durDif)) +
geom_point(alpha = 0.5, shape = 1) +
#geom_smooth(method = "lm", linetype = 1, color = "white", linewidth = 2) +
geom_smooth(method = "lm", linetype = 1, color = "black") +
labs(x = "Geographic distance (km)", y = "Difference in infestation duration (years)") +
annotate(
geom = "text",
label = expression(paste("Mantel r = 0.75,", italic("P"), " = 0.001")),
x = 1750,
y = 2.5
) +
my_gg_theme.def_size
p1
pdf("figures/pop_gen/IBD/geo_v_infestation_duration.pdf", width = 6.5, height = 3.5)
p1
dev.off()
q(save="no")
