scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
#################
#################
# annotate each panel with the number of sites (within) or site pairs (bn)
# Third panel with bootstrapped means and 95% CIs
#
#just within
#
n_tab = data.frame(
lab = paste("n sites =", c(Nf.within.site_n, Nd.within.site_n, Nc.within.site_n)),
spp = c("Nf", "Nd", "Nc"),
y = c(50, 7, 4)
)
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
scale_y_continuous(
limits = ~ c(min(.x), ceiling(max(.x))),
breaks = ~ .x[2],
expand = c(0, 0)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
scale_y_continuous(
limits = ~ c(min(.x), ceiling(max(.x))),
breaks = ~ .x[5],
expand = c(0, 0)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
scale_y_continuous(
limits = ~ c(min(.x), ceiling(max(.x))),
breaks = ~ .x[1],
expand = c(0, 0)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
scale_y_continuous(
limits = ~ c(min(.x), ceiling(max(.x))),
breaks = ~ (.x[1], .x[2])
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
scale_y_continuous(
limits = ~ c(min(.x), ceiling(max(.x))),
breaks = ~ c(.x[1], .x[2])
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
install.packages("ggh4x")
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
#ggh4x::facetted_pos_scales(
#    y = list(
#        spp == "Nf" ~ scale_y_continuous(limits = c(0, NA)),
#        spp == "Nd" ~ scale_y_continuous(breaks = c(2.9, 3, 3.1)),
#        spp == "Nc" ~ scale_y_continuous(trans = "reverse")
#    )
#) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
ggh4x::facetted_pos_scales(
y = list(
#        spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
spp == "Nd" ~ scale_y_continuous(breaks = c(0,5,10)),
#        spp == "Nc" ~ scale_y_continuous(trans = "reverse")
)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
ggh4x::facetted_pos_scales(
y = list(
#        spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
spp == "Nd" ~ scale_y_continuous(breaks = c(0,5,10))
#        spp == "Nc" ~ scale_y_continuous(trans = "reverse")
)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
ggh4x::facetted_pos_scales(
y = list(
#        spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
factor(spp) == "Nd" ~ scale_y_continuous(breaks = c(0,5,10))
#        spp == "Nc" ~ scale_y_continuous(trans = "reverse")
)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
ggh4x::facetted_pos_scales(
y = list(
#        spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
"spp" == "Nd" ~ scale_y_continuous(breaks = c(0,5,10))
#        spp == "Nc" ~ scale_y_continuous(trans = "reverse")
)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
vars(factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
)),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
ggh4x::facetted_pos_scales(
y = list(
#        spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
"spp" == "Nd" ~ scale_y_continuous(breaks = c(0,5,10))
#        spp == "Nc" ~ scale_y_continuous(trans = "reverse")
)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
vars(factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
)),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
ggh4x::facetted_pos_scales(
y = list(
#        spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
spp == "Nd" ~ scale_y_continuous(breaks = c(0,5,10))
#        spp == "Nc" ~ scale_y_continuous(trans = "reverse")
)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
# ggh4x::facetted_pos_scales(
#    y = list(
#        spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
#        "spp" == "Nd" ~ scale_y_continuous(breaks = c(0,5,10))
#        spp == "Nc" ~ scale_y_continuous(trans = "reverse")
#    )
#) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
ggh4x::scale_y_facet(
spp == "Nd", scale_y_continuous(breaks = c(0,5,10))
) +
# ggh4x::facetted_pos_scales(
#    y = list(
#        spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
#        "spp" == "Nd" ~ scale_y_continuous(breaks = c(0,5,10))
#        spp == "Nc" ~ scale_y_continuous(trans = "reverse")
#    )
#) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
#ggh4x::scale_y_facet(
#    spp == "Nd", scale_y_continuous(breaks = c(0,5,10))
#) +
ggh4x::facetted_pos_scales(
y = list(
#spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
#"spp" == "Nd" ~ scale_y_continuous(breaks = c(0,5,10))
#spp == "Nc" ~ scale_y_continuous(trans = "reverse")
scale_y_continuous(breaks = c(0, 25, 50, 75)),
scale_y_continuous(breaks = c(0, 5, 10)),
scale_y_continuous(breaks = c(0, 3, 6))
)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
#ggh4x::scale_y_facet(
#    spp == "Nd", scale_y_continuous(breaks = c(0,5,10))
#) +
ggh4x::facetted_pos_scales(
y = list(
#spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
#"spp" == "Nd" ~ scale_y_continuous(breaks = c(0,5,10))
#spp == "Nc" ~ scale_y_continuous(trans = "reverse")
scale_y_continuous(breaks = c(0, 40, 80)),
scale_y_continuous(breaks = c(0, 5, 10)),
scale_y_continuous(breaks = c(0, 3, 6))
)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
p1 = ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd", "Nc"),
labels = c("N. faginata", "N. ditissima", "N. coccinea")
),
scales = "free_y",
ncol = 1
) +
scale_x_continuous(limits = c(0,15)) +
#ggh4x::scale_y_facet(
#    spp == "Nd", scale_y_continuous(breaks = c(0,5,10))
#) +
ggh4x::facetted_pos_scales(
y = list(
#spp == "Nf" ~ scale_y_continuous(limits = c(0, 80)),
#"spp" == "Nd" ~ scale_y_continuous(breaks = c(0,5,10))
#spp == "Nc" ~ scale_y_continuous(trans = "reverse")
spp == "Nf" ~ scale_y_continuous(breaks = c(0, 40, 80)),
spp == "Nd" ~ scale_y_continuous(breaks = c(0, 5, 10)),
spp == "Nc" ~ scale_y_continuous(breaks = c(0, 3, 6))
)
) +
geom_text(data = n_tab, x = 12, aes(y = y, label = lab)) +
my_gg_theme +
labs(x = "Hamming distance (SNPs per Kb)", y = "Within site comparisons (count)", title = "a") +
theme(
plot.title = element_text(hjust = -0.12)
)
p1
q(save="no")
library(vcfR)
# Nc
vcf <- read.vcfR("data/Nc/final_tables/rm_dups/FINAL_snp.mac_ge2.biallele.LD.structure_analyses.vcf.gz", verbose = FALSE)
# Nc
vcf <- read.vcfR("data/Nc/final_tables/FINAL_snp.mac_ge2.biallele.LD.structure_analyses.vcf.gz", verbose = FALSE)
gt <- extract.gt(vcf, element='GT', as.numeric=TRUE)
head(gt)
gt[is.na(gt)] = -9
head(gt)
gt_str = t(gt)
nrow(gt_str)
#30 individuals (for structure input options)
n_snps = ncol(gt_str)
n_snps
#2210 snps  (for structure input options)
colnames(gt_str) = paste("SNP_", seq(1, n_snps), sep = "")
head(gt_str[,1:5])
write.table(gt_str, "data/Nc/final_tables/FINAL_snp.structure", quote = F, sep = "\t", row.names = T, col.names = NA)
q(save="no")
