Nd.Dgen.long$spp = "Nd"
ggplot(rbind(Nf.Dgen.long, Nd.Dgen.long),
aes(x = value)
) +
geom_histogram() +
facet_grid(spp~comp) +
theme_bw()
library(ggplot)
source("library/ggplot_theme.txt")
library(ggplot2)
source("library/ggplot_theme.txt")
ggplot(rbind(Nf.Dgen.long, Nd.Dgen.long),
aes(x = value)
) +
geom_histogram() +
facet_grid(spp~comp) +
theme_bw()
?facet_grid
ggplot(rbind(Nf.Dgen.long, Nd.Dgen.long),
aes(x = value)
) +
geom_histogram() +
facet_grid(spp~comp, scales = "free_y") +
theme_bw()
ggplot(rbind(Nf.Dgen.long, Nd.Dgen.long),
aes(x = value)
) +
geom_histogram() +
facet_grid(comp~spp, scales = "free_y") +
theme_bw()
ggplot(rbind(Nf.Dgen.long, Nd.Dgen.long),
aes(x = value)
) +
geom_histogram() +
facet_grid(spp~comp, scales = "free_y") +
theme_bw()
all.Dgen = rbind(Nf.Dgen.long, Nd.Dgen.long)
all.Dgen = all.Dgen[!is.na(all.Dgen$value,]
all.Dgen = all.Dgen[!is.na(all.Dgen$value),]
geom_histogram() +
facet_grid(spp~comp, scales = "free_y") +
theme_bw()
all.Dgen = rbind(Nf.Dgen.long, Nd.Dgen.long)
all.Dgen = all.Dgen[!is.na(all.Dgen$value),]
ggplot(all.Dgen,
aes(x = value)
) +
geom_histogram() +
facet_grid(spp~comp, scales = "free_y") +
theme_bw()
ggplot(all.Dgen,
aes(x = value)
) +
geom_histogram() +
facet_grid(spp~comp, scales = "free_y") +
my_gg_theme()
ggplot(all.Dgen,
aes(x = value)
) +
geom_histogram() +
facet_grid(spp~comp, scales = "free_y") +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram() +
facet_wrap(spp~comp, scales = "free_y", ncol = 1) +
theme_bw()
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram() +
facet_wrap(~comp, scales = "free_y", ncol = 1) +
my_gg_theme()
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram() +
facet_wrap(~comp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram() +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(bins = 5) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(bins = 15) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(bins = 25) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(bins = 35) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(bins = 45) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(bins = 75) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(bins = 50) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(binwidth = 0.01) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(binwidth = 0.001) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(binwidth = 0.005) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "between"),
aes(x = value)
) +
geom_histogram(binwidth = 0.005) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(binwidth = 0.0025) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
ggplot(all.Dgen %>% filter(comp == "between"),
aes(x = value)
) +
geom_histogram(binwidth = 0.0025) +
facet_wrap(~spp, scales = "free_y", ncol = 1) +
my_gg_theme
?ape::dist.dna
dnaBin.Nd = adegenet::fasta2DNAbin(file = "data/Nd/final_tables/rm_dups/FINAL_snp.snps_only.for_phylogeny.fasta")
dnaBin.Nf = adegenet::fasta2DNAbin(file = "data/Nf/final_tables/rm_dups/FINAL_snp.snps_only.for_phylogeny.fasta")
?adegenet::fasta2DNAbin
rm(dnaBin.Nf)
rm(dnaBin.Nd)
gc()
head(Nf.Dgen.long)
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(binwidth = 0.0025) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just between
ggplot(all.Dgen %>% filter(comp == "between"),
aes(x = value)
) +
geom_histogram(binwidth = 0.0025) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(binwidth = 0.0025) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(binwidth = 0.001) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(binwidth = 0.002) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = value)
) +
geom_histogram(binwidth = 0.005) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#convert distances to nucelotide difs (instead of proportional) and
# correct for genome size (see IBD.individuals.calculate_hamming for number comps)
Nf.Dgen.long$difsPerKb = Nf.Dgen.long$value * 999132 / 42948.211
Nd.Dgen.long$difsPerKb = Nd.Dgen.long$value * 1413869 / 44950817
#counts of instances
sum(Nf.Dgen.long$comp == "within", na.rm = T)
#682
sum(Nf.Dgen.long$comp == "between", na.rm = T)
#11974
sum(Nd.Dgen.long$comp == "within", na.rm = T)
#40
sum(Nd.Dgen.long$comp == "between", na.rm = T)
#dfs for anova
#within
Nf.withins = Nf.Dgen.long[Nf.Dgen.long$comp == "within" & !is.na(Nf.Dgen.long$value),]
Nf.withins$spp = "Nf"
Nd.withins = Nd.Dgen.long[Nd.Dgen.long$comp == "within" & !is.na(Nd.Dgen.long$value),]
Nd.withins$spp = "Nd"
comp.withins = rbind(Nf.withins, Nd.withins)
nrow(comp.withins)
#between
Nf.betweens = Nf.Dgen.long[Nf.Dgen.long$comp == "between" & !is.na(Nf.Dgen.long$value),]
Nf.betweens$spp = "Nf"
Nd.betweens = Nd.Dgen.long[Nd.Dgen.long$comp == "between" & !is.na(Nd.Dgen.long$value),]
Nd.betweens$spp = "Nd"
comp.betweens = rbind(Nf.betweens, Nd.betweens)
nrow(comp.betweens)
#aov within sites
aov.withins = aov(difsPerKb ~ spp, comp.withins)
qqnorm(residuals(aov.withins))
plot(residuals(aov.withins))
summary(aov.withins)
#aov between sites
aov.betweens = aov(difsPerKb ~ spp, comp.betweens)
qqnorm(residuals(aov.betweens))
plot(residuals(aov.betweens))
summary(aov.betweens)
#plot
Nf.Dgen.long$spp = "Nf"
Nd.Dgen.long$spp = "Nd"
all.Dgen = rbind(Nf.Dgen.long, Nd.Dgen.long)
all.Dgen = all.Dgen[!is.na(all.Dgen$value),]
ggplot(all.Dgen,
aes(x = difsPerKb)
) +
geom_histogram() +
facet_grid(spp~comp, scales = "free_y") +
my_gg_theme
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.005) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just between
ggplot(all.Dgen %>% filter(comp == "between"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.0025) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just between
ggplot(all.Dgen %>% filter(comp == "between"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#convert distances to nucelotide difs (instead of proportional) and
# correct for genome size (see IBD.individuals.calculate_hamming for number comps)
Nf.Dgen.long$difsPerKb = Nf.Dgen.long$value * 999132 / 42948.211
Nd.Dgen.long$difsPerKb = Nd.Dgen.long$value * 1413869 / 44950.817
#counts of instances
sum(Nf.Dgen.long$comp == "within", na.rm = T)
#682
sum(Nf.Dgen.long$comp == "between", na.rm = T)
#11974
sum(Nd.Dgen.long$comp == "within", na.rm = T)
#40
sum(Nd.Dgen.long$comp == "between", na.rm = T)
#dfs for anova
#within
Nf.withins = Nf.Dgen.long[Nf.Dgen.long$comp == "within" & !is.na(Nf.Dgen.long$value),]
Nf.withins$spp = "Nf"
Nd.withins = Nd.Dgen.long[Nd.Dgen.long$comp == "within" & !is.na(Nd.Dgen.long$value),]
Nd.withins$spp = "Nd"
comp.withins = rbind(Nf.withins, Nd.withins)
nrow(comp.withins)
#between
Nf.betweens = Nf.Dgen.long[Nf.Dgen.long$comp == "between" & !is.na(Nf.Dgen.long$value),]
Nf.betweens$spp = "Nf"
Nd.betweens = Nd.Dgen.long[Nd.Dgen.long$comp == "between" & !is.na(Nd.Dgen.long$value),]
Nd.betweens$spp = "Nd"
comp.betweens = rbind(Nf.betweens, Nd.betweens)
nrow(comp.betweens)
#aov within sites
aov.withins = aov(difsPerKb ~ spp, comp.withins)
qqnorm(residuals(aov.withins))
plot(residuals(aov.withins))
summary(aov.withins)
#aov between sites
aov.betweens = aov(difsPerKb ~ spp, comp.betweens)
qqnorm(residuals(aov.betweens))
plot(residuals(aov.betweens))
summary(aov.betweens)
#plot
Nf.Dgen.long$spp = "Nf"
Nd.Dgen.long$spp = "Nd"
all.Dgen = rbind(Nf.Dgen.long, Nd.Dgen.long)
all.Dgen = all.Dgen[!is.na(all.Dgen$value),]
ggplot(all.Dgen,
aes(x = difsPerKb)
) +
geom_histogram() +
facet_grid(spp~comp, scales = "free_y") +
my_gg_theme
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
ggplot(all.Dgen,
aes(x = difsPerKb)
) +
geom_histogram() +
facet_grid(spp~comp, scales = "free_y") +
my_gg_theme
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.5) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.25) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just wihtin
ggplot(all.Dgen %>% filter(comp == "within"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
#just between
ggplot(all.Dgen %>% filter(comp == "between"),
aes(x = difsPerKb)
) +
geom_histogram(binwidth = 0.1) +
facet_wrap(
~factor(spp, levels = c("Nf", "Nd"),
labels = c("N. faginata", "N. ditissima")
),
scales = "free_y",
ncol = 1
) +
my_gg_theme +
labs(x = "Hamming distance")
q(save="no")
